---
layout: post
title: Повторение команды до посинения
tags: [linux, cli]
---
Мне пригодилось, когда консольная утилита что-то качала, но то соединение было хреновым. 

В bash есть [механизм подстановки истории](https://www.gnu.org/software/bash/manual/html_node/Event-Designators.html), с помощью которого можно заменить, например, `!3` на третью команду из истории. Когда есть <kbd>Ctrl</kbd>+<kbd>r</kbd> (поиск по истории) и банальные стрелочки — это довольно бесполезно, однако есть шаблон `!!`, который заменяется предыдущей командой. 

`!!` очень удобен, например, для `sudo !!` (\*блеать.jpg\*). И пригодится для повтора:
```sh
while [ $? -ne 0 ]; do !!; done
```
Эта команда будет выполнять предыдущую, пока не будет успешный ответ. Можно [завернуть в альяс](https://stackoverflow.com/a/24770962/1003491).
