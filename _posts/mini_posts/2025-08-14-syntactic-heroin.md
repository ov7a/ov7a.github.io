---
layout: post
title: Синтаксический героин
tags: [compiler]
tg_id: 645
---
Забавный термин, на который случайно [наткнулся](https://wiki.haskell.org/Syntactic_sugar/Cons) в вики Haskell (я туда попал по запросу "cons in Haskell", который оператор для вставки в начало). Сама статья — про недостатки синтаксического сахара и опасность его чрезмерного использования: нужно помнить много конструкций; иногда не знаешь, во что транслируется выражение с сахаром; хуже ошибки компилятора; тяжело переписывать код, когда он не укладывается в "сахарный" сценарий; сложнее писать инструменты типа линтеров; разработчики "подсаживаются" на сахар, и просят добавить еще.

Однако это только одна сторона медали, и на эту статью есть довольно [выдержанный ответ](https://wiki.haskell.org/index.php?title=Haskell_programming_tips/Discussion), который указывает на специфичность некоторых моментов именно для конкретной реализации компилятора и вообще, надо с умом его использовать, для того, чтобы код был более читаемым, а не просто ради удобства.

На мой взгляд, основная проблема некоторый языков в этом плане — консистентность и единообразность. В Scala 2 коде, написанном в Haskell-стиле, сахар превращается в то, что тебе нужно помнить отличия всяких `+:+`, `++:` и прочих `(_*_)`. Кроме того, не хватает [единого стиля](/2024/04/18/official-style.html), в Scala 3 с этим стало в целом получше. А вот в Kotlin проблема с сахаром в том, что тебе нужно выбрать тот самый вспомогательный метод из миллиона других, который подходит именно под этот конкретный случай. "Практично", но иногда [безсистемно](/2016/02/29/habr-how-to-shoot-yourself-in-a-leg-with-kotlin.html#section-4). В идеале должен быть хороший, но минимальный "фундамент" языка с хорошими возможностями для расширения.

А вообще стоит почитать [оригинальную статью](https://dl.acm.org/doi/pdf/10.1145/1071713.1071738) от 2005 года, где синтаксическим героином называют... перегрузку функций.
