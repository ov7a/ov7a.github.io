---
layout: post
title: Зачем ограничивать длину пароля
tags: [иб]
tg_id: 591
---
С учетом того, что пароли все равно хэшируют, их размер не должен иметь большого значения. Если у пароль есть ограничение сверху на длину или на символы, которые могут быть использованы, то одна из первых мыслей, которая приходит в голову — пароль хранят в открытом виде.

Но не все так просто. Есть и более адекватные причины ограничивать размер пароля:
- DoS (тратим много лишнего CPU на хэширование пароля из миллиона символов и/или ваш сервер не может обработать запрос больше мегабайта).
- Атака на переполнение буфера (в ваш массив на 256 байт, которого хватит всем, запихнули 257 символов).
- У алгоритма хэширования могут быть ограничения. Знали ли вы, что у bcrypt есть [ограничение на длину](https://security.stackexchange.com/questions/39849/does-bcrypt-have-a-maximum-password-length/39851#39851) и что это [реальная проблема](https://n0rdy.foo/posts/20250121/okta-bcrypt-lessons-for-better-apis/) даже в современных реализациях?

Еще могут упомянуть интеграцию с легаси-системами, но это по сути то же самое, что хранить пароль в открытом виде и/или переиспользовать его. Уж лучше использовать какой-то алгоритм деривации для подобного.

Но чаще всего ограничение сверху это чья-то ошибка, потому что обычно это не 50-100 символов, которые могут быть адекватными, а 16-20. Больше дебильных правил можно найти [тут](https://dumbpasswordrules.com/sites/).

P.S. Если спросить ChatGPT про то, зачем ограничивать длину пароля, никакого намека на ограничения алгоритма он вам не даст. 
