---
layout: post
title: Какие изменения принесет kubectl apply?
tags: [k8s]
tg_id: 356
---
Если доступ к кластеру имеют несколько человек, и кто-то забыл закоммитить yaml в гит, то можно узнать кластера простым выводом в `yaml`, например:
```sh
kubectl get deploy --all-namespaces -o yaml  > all-deployment.yaml
```
Однако можно просто посмотреть на отличия манифеста, который есть в репе и того, что есть по факту на кластере:
```sh
kubectl diff -f deployment.yaml
```
аргументы — такие же, как у `apply`. Можно еще посмотреть `diff` в графическом редакторе:
```sh
KUBECTL_EXTERNAL_DIFF=meld kubectl diff -f deployment.yaml
```
К сожалению, `diff` может провалиться из-за того, что поменялись неизменяемые поля (`labels`, например). В этом случае придется получить текущее состояние, поправить поля и попробовать `diff` еще раз.

